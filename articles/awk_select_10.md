---
title: "awkã®æ´»ç”¨ä¾‹6é¸ - grep/sed/cutã‚³ãƒãƒ³ãƒ‰ã¨ã®æ¯”è¼ƒ"
emoji: "ğŸ•Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["AWK", "Linuxã‚³ãƒãƒ³ãƒ‰"]
published: false
---

# ã¯ã˜ã‚ã«
æ•°ã‚«æœˆå‰ã¾ã§awkã«å¯¾ã—ã¦è‹¦æ‰‹æ„è­˜ãŒã‚ã‚Šã€æŠ€è¡“æ›¸ç±ã‚’è³¼å…¥ã—ã¦è‰²ã€…å‹‰å¼·ã—ã¾ã—ãŸã€‚
ãã®çµæœã€ã‚ã‚‹ç¨‹åº¦ã¯è§¦ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ããŸã®ã§ã€awkãŒæ´»ç”¨ã§ãã‚‹å®Ÿè·µä¾‹ã‚’ç´¹ä»‹ã§ãã‚Œã°ã¨ãŠã‚‚ã„ã¾ã™ã€‚
ã“ã®è¨˜äº‹ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¯ä»¥ä¸‹ã®æ–¹ã§ã™ã€‚
- ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ»çµ„ã¿è¾¼ã¿å¤‰æ•°ãƒ»é–¢æ•°ãªã©ã‚ã‚‹ç¨‹åº¦ã®çŸ¥è­˜ãŒã‚ã‚‹
- grep/sedã¯ã‚ã‚‹ç¨‹åº¦ä½¿ãˆã‚‹ãŒã€awkã‚’ä½¿ã†å ´é¢ã«ãƒ”ãƒ³ã¨æ¥ãªã„

ä»Šã®ä¼šç¤¾ã«å…¥ç¤¾ã—ãŸã“ã‚ã‹ã‚‰æ­£è¦è¡¨ç¾ã«è§¦ã‚Œã‚‹ã“ã¨ãŒå¤šã‹ã£ãŸã®ã§ã€grepã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚‚å«ã‚ã¦ã™ãã«ãƒã‚¹ã‚¿ãƒ¼å‡ºæ¥ã¾ã—ãŸã€‚sedã«ã¤ã„ã¦ã¯ç‹¬ç‰¹ãªç™–ã‚‚ã‚ã‚‹ã“ã¨ã‹ã‚‰æŠµæŠ—ãŒã‚ã£ãŸã®ã§ã™ãŒã€æ¥­å‹™ã§ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†ã‚’ã™ã‚‹æ©Ÿä¼šãŒå¤šã‹ã£ãŸãŸã‚ã€é ‘å¼µã£ã¦ç¿’å¾—ã—ã¾ã—ãŸã€‚
ã—ã‹ã—ã€awkã ã‘ã¯ä½¿ã„ã©ã“ã‚ãŒã©ã†ã«ã‚‚ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ããšã€ã¾ãŸgrep/sedã«åŠ ãˆã¦PythonãŒã‚ã‚‹ç¨‹åº¦ä½¿ãˆã‚Œã°ãã“ã¾ã§å¿…è¦ã«ãªã‚‹ã“ã¨ã‚‚ãªã„ã ã‚ã†ã¨è€ƒãˆã¦ãŠã‚Šã€ä½•ã¨ãªãawkã‚’é¿ã‘ã¦ã„ã¾ã—ãŸã€‚
ä½¿ãˆã‚‹æ–¹ãŒãã£ã¨ã‚‚ã£ã¨Shellãƒ©ã‚¤ãƒ•ãŒè±Šã‹ã«ãªã‚‹ã«é•ã„ãªã„ï¼ã¨è¬ã®ç¢ºä¿¡ã‚’æŠ±ãã€æ€ã„ç«‹ã£ã¦å‹‰å¼·ã‚’å§‹ã‚ã¾ã—ãŸã€‚

## å­¦ç¿’ã«ä½¿ç”¨ã—ãŸæ›¸ç±
ã€Œã‚·ã‚§ãƒ«èŠ¸ã€ã«åŠ¹ãï¼AWKå‡¦æ–¹ç®‹
Amazon: http://www.amazon.co.jp/dp/B01MYDZ55O

awkã®æ–‡æ³•ã‚’ãã¡ã‚“ã¨å­¦ã¶ã®ã«å¿…è¦ãªçŸ¥è­˜ãŒè©°ã¾ã£ã¦ã„ã¾ã™ã€‚
é•·æ‰€ãƒ»çŸ­æ‰€ã‚‚ã‚ˆãã¾ã¨ã¾ã£ã¦ã„ã‚‹å°è±¡ã§ã™ã€‚


## ä½¿ç”¨ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«1
å®Ÿéš›ã«æ–‡å­—åˆ—å‡¦ç†ã®ç·´ç¿’ã‚’ã™ã‚‹éš›ã€ã‚ã‚‹ç¨‹åº¦å¤§ãã„é©å½“ãªãƒ‡ãƒ¼ã‚¿ãŒæ¬²ã—ããªã‚Šã¾ã™ã€‚
ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚„ç–‘ä¼¼å€‹äººæƒ…å ±ãªã©ã‚’æ´»ç”¨ã—ãŸã‚Šã€è‡ªåˆ†ã®ç«¯æœ«ã‹ã‚‰é©å½“ãªOSãƒ­ã‚°ã‚’å¼•ã£å¼µã£ã¦ããŸã‚Šã—ã¦ã‚‚è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚[^2]
[^2]: ã†ã£ã‹ã‚Šäº‹æ•…ãŒèµ·ããŸã‚‰å±ãªã„ã®ã§ã€æ©Ÿå¯†æƒ…å ±ã‚„ä»•äº‹ç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ã®ã¯é¿ã‘ã¾ã—ã‚‡ã†â€¦ã€‚
ä»Šå›ã¯ã€é›†è¨ˆãªã©ã®èª¬æ˜ã‚’ã™ã‚‹éš›ã«ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚é•·ããªã‚‹ã®ãŒå«Œãªã®ã§çœç•¥ã—ã¦ã„ã¾ã™ã€‚

:::details ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¡¨ç¤º 
```txt:weather_info.txt
æ—¥ä»˜,æ™‚åˆ»,å¤©æ°—,èª¬æ˜,æ°—æ¸©,æœ€é«˜æ°—æ¸©,æœ€ä½æ°—æ¸©,æ¹¿åº¦
2022-03-05,03:00:00,Clouds,æ›‡ã‚ŠãŒã¡,8.21,9.04,8.21,75
2022-03-05,06:00:00,Clouds,é›²,8.09,8.24,8.09,72
2022-03-05,09:00:00,Clouds,é›²,9.51,9.51,9.51,57
2022-03-05,12:00:00,Clear,æ™´å¤©,13.28,13.28,13.28,32
2022-03-05,15:00:00,Clear,æ™´å¤©,17.62,17.62,17.62,27
2022-03-05,18:00:00,Clear,æ™´å¤©,15.99,15.99,15.99,30
2022-03-05,21:00:00,Clear,æ™´å¤©,13.77,13.77,13.77,35
2022-03-06,00:00:00,Clear,æ™´å¤©,9.61,9.61,9.61,35
2022-03-06,03:00:00,Clouds,è–„ã„é›²,7.41,7.41,7.41,32
2022-03-06,06:00:00,Clouds,æ›‡ã‚ŠãŒã¡,7.31,7.31,7.31,27
2022-03-06,09:00:00,Clouds,æ›‡ã‚ŠãŒã¡,9.04,9.04,9.04,26
2022-03-06,12:00:00,Clouds,æ›‡ã‚ŠãŒã¡,10.71,10.71,10.71,21
2022-03-06,15:00:00,Clouds,æ›‡ã‚ŠãŒã¡,10.88,10.88,10.88,20
2022-03-06,18:00:00,Clouds,é›²,8.24,8.24,8.24,26
2022-03-06,21:00:00,Clouds,è–„ã„é›²,7.25,7.25,7.25,29
2022-03-07,00:00:00,Clear,æ™´å¤©,6.7,6.7,6.7,30
2022-03-07,03:00:00,Clear,æ™´å¤©,5.89,5.89,5.89,33
2022-03-07,06:00:00,Clear,æ™´å¤©,5.49,5.49,5.49,36
2022-03-07,09:00:00,Clouds,é›²,7.92,7.92,7.92,24
2022-03-07,12:00:00,Clouds,åšã„é›²,10.48,10.48,10.48,24
2022-03-07,15:00:00,Clouds,åšã„é›²,11.74,11.74,11.74,38
2022-03-07,18:00:00,Clouds,åšã„é›²,9.66,9.66,9.66,59
2022-03-07,21:00:00,Rain,å°é›¨,8.2,8.2,8.2,60
2022-03-08,00:00:00,Rain,å°é›¨,7.56,7.56,7.56,69
2022-03-08,03:00:00,Rain,é©åº¦ãªé›¨,5.55,5.55,5.55,89
2022-03-08,06:00:00,Rain,å°é›¨,4.87,4.87,4.87,87
2022-03-08,09:00:00,Rain,å°é›¨,4.76,4.76,4.76,86
2022-03-08,12:00:00,Clouds,åšã„é›²,6.36,6.36,6.36,76
2022-03-08,15:00:00,Clouds,æ›‡ã‚ŠãŒã¡,9.18,9.18,9.18,58
2022-03-08,18:00:00,Clouds,è–„ã„é›²,9.5,9.5,9.5,53
2022-03-08,21:00:00,Clouds,è–„ã„é›²,7.75,7.75,7.75,60
```
:::
â€»Open Weather Map API[^1]ã‚’åˆ©ç”¨ã—ã¦å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§åŠ å·¥ã—ãŸã‚‚ã®ã§ã™ã€‚
[^1]: Open Weather Map API https://openweathermap.org/

# å®Ÿè·µä¾‹1. ç‰¹å®šã®ç¯„å›²ã‚’æŠœãå‡ºã™
## è¡Œç•ªå·ã‚’å…ƒã«æŠ½å‡º
SQLã®ã€Œlimit A offset Bã€ã®ã‚ˆã†ãªå‡¦ç†ã«ã‚‚è¿‘ã„ã§ã™ã­ã€‚
ä¾‹ãˆã°ã€200è¡Œã‚ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãªã‹ã§ã€ã‚¨ãƒ©ãƒ¼ãŒ30ï½45è¡Œç›®è¾ºã‚Šã®ãƒ­ã‚¸ãƒƒã‚¯ã§ç™ºç”Ÿã—ã¦ã„ã‚‹ã¨ã„ã£ãŸã€ç‰¹å®šã®æƒ…å ±ãŒè¨˜è¼‰ã•ã‚ŒãŸè¡ŒãŒã¯ã£ãã‚Šã—ã¦ã„ã‚‹ã‚±ãƒ¼ã‚¹ã§ã“ã®ã‚ˆã†ãªå‡¦ç†ã‚’ã—ãŸã„ã‚±ãƒ¼ã‚¹ãŒå‡ºã¦ãã¾ã™ã€‚

```bash
awk 'NR>=30&&NR<=45' 
cat 
```
## çµ„ã¿è¾¼ã¿å¤‰æ•°NR
awkã‚’ä½¿ã†ä¸Šã§è¦šãˆã‚‹ã¹ãçµ„ã¿è¾¼ã¿å¤‰æ•°ã‹ã¨æ€ã„ã¾ã™ã€‚

åŒæ§˜ã®å‡¦ç†ã‚’sedã§ã‚‚è¡Œã†ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚
```bash
sed -n '30,45p'
```
ã“ã¡ã‚‰ã®ã»ã†ãŒã‚·ãƒ³ãƒ—ãƒ«ã‹ã‚‚â€¦ã€‚

## awkã®æ–¹ãŒå„ªã‚Œã¦ã„ãã†ãªã‚±ãƒ¼ã‚¹
ãŸã ã®ç¯„å›²æŠ½å‡ºãªã‚‰ã°sedã§è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚
ã—ã‹ã—ã€æŠ½å‡ºã—ãŸã†ãˆã§ãã®ã¾ã¾ç‰¹å®šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŠœãå‡ºã™ã€åŠ å·¥ã™ã‚‹ç­‰ã‚’ä¸€åº¦ã«è¡Œãˆã‚‹ã¨ã„ã†ç‚¹ã§awkã¯å„ªã‚Œã¦ã„ã¾ã™ã€‚

ã¾ãŸã€è¡ŒæŠ½å‡ºã«ã¤ã„ã¦ã‚‚awkã®ã»ã†ãŒæ¥½ãªã‚±ãƒ¼ã‚¹ã¯å¤šã€…å­˜åœ¨ã—ã¾ã™ã€‚
ä¾‹ãˆã°ã€ç´ æ•°ä¸€è¦§ã‚’ä½•ã‚‰ã‹ã®æ–¹æ³•ã§å–å¾—ã—ãŸã¨ã—ã¦ã€10ç•ªç›®ã€20ç•ªç›®ã€â€¦ã®ç´ æ•°ã‚’çŸ¥ã‚ŠãŸã„ã¨ãã¯
```bash
... | awk 'NR%10==0'
```
ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãŒå¯¾è±¡ã§ãªãã¨ã‚‚ã€

## æ–‡å­—åˆ—ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å…ƒã«ç¯„å›²ã‚’æŠ½å‡º



## æ–‡å­—åˆ—ã‚’å…ƒã«æŠ½å‡º

# å®Ÿè·µä¾‹2. é‡è¤‡è¡Œæ’é™¤
awkã®é€£æƒ³é…åˆ—ã‚’ä¸Šæ‰‹ãåˆ©ç”¨ã—ã¦ã€ãƒ†ã‚­ã‚¹ãƒˆã®é‡è¤‡è¡Œã®æ’é™¤ã‚’ã™ã‚‹ã“ã¨ã‚‚å‡ºæ¥ã¾ã™ã€‚
ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ç™»å ´ã™ã‚‹OSã®ç¨®é¡ã‚’åˆ—æŒ™ã—ãŸã„ã¨ã—ã¾ã™ã€‚

```txt:oslist.txt
Windows
Windows
Mac
Windows
Mac
Mac
Linux
Windows
Windows
Mac
Mac
Windows
Linux
Mac
Linux
```

```bash:å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
cat oslist.txt | awk '!a[$0]++'
```
```txt:å®Ÿè¡Œçµæœ
Windows
Mac
Linux
```

## å®Ÿè¡Œçµæœã®è§£é‡ˆ
awkã®é€£æƒ³é…åˆ—ã‚’ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã¨ã—ã¦ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
`$0`ã§è¡Œå…¨ä½“ã‚’ã‚­ãƒ¼ã¨ã—ã¦ã€å¤‰æ•°aã®ã‚­ãƒ¼`$0`ã«å¯¾å¿œã™ã‚‹å€¤ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã—ã¾ã™ã€‚
**å¾Œç½®ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ**ã®ãŸã‚ã€æœ€åˆã¯`a[$0]==0`ã™ãªã‚ã¡`False`ã¨ã—ã¦è©•ä¾¡ã•ã‚Œã€`!`ã«ã‚ˆã£ã¦åè»¢ã—ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒ`True`ã¨ãªã‚Šã¾ã™ã€‚
2å›ç›®ä»¥é™ã¯ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®å€¤ã¯1ä»¥ä¸Šã¨ãªã£ã¦ã„ã‚‹ã®ã§ã€`(1ä»¥ä¸Šã®æ•°å€¤)`ã™ãªã‚ã¡`True`ã€`!`ã«ã‚ˆã£ã¦åè»¢ã—ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒ`False`ã¨ãªã‚Šã¾ã™ã€‚
ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ã¯`print $0`ãŒçœç•¥ã•ã‚Œã¦ãŠã‚Šã€æœ€åˆã®ä¸€å›ã®ã¿å‡ºåŠ›ã•ã‚Œã‚‹ã¨ã„ã£ãŸæŒ™å‹•ã¨ãªã‚Šã¾ã™ã€‚
ã“ã®ä»•çµ„ã¿ã§ã€ã‚¿ã‚¤ãƒ—æ•°ãŒéå¸¸ã«å°‘ãªãã€ã‚¹ãƒªãƒ ã«è¦‹ãˆã‚‹ã®ãŒç´ æ™´ã‚‰ã—ã„ã§ã™ã­ã€‚


## `sort | uniq`ã€`sort -u`ã¨ã®æ¯”è¼ƒ
Linuxã‚³ãƒãƒ³ãƒ‰ã§ã®é‡è¤‡è¡Œæ’é™¤ã¨ã„ãˆã°ä»¥ä¸‹ãŒæœ‰åã§ã™ã€‚
ã“ã¡ã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ãŒæ€ã„æµ®ã‹ã‚“ã æ–¹ã‚‚å°‘ãªããªã„ã§ã—ã‚‡ã†ã€‚
```bash
sort | uniq
sort -u
```

uniqã‚³ãƒãƒ³ãƒ‰ãŒãã‚‚ãã‚‚é‡è¤‡æ’é™¤ã®ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ã§ã™ãŒã€ã“ã®ã‚³ãƒãƒ³ãƒ‰ã§ã¯ã€Œç›´å‰ã®è¡Œã¨åŒã˜å€¤ãŒå‡ºã¦ããŸã‚‰å‡ºåŠ›ã‚’ã—ãªã„ã€ã¨ã„ã£ãŸå‹•ãã‚’ã—ã¾ã™ã€‚
ãã®ãŸã‚ã€äº‹å‰ã«sortã‚’ã—ã¦ã„ã‚‹ã“ã¨ãŒå¿…è¦ã¨ã•ã‚Œã¾ã™ã€‚[^1]
[^1]: ä¸€è¦‹ä¸ä¾¿ãªã‚ˆã†ã«ã¿ãˆã¾ã™ãŒã€çŠ¶æ³ã«ã‚ˆã£ã¦ã¯æ•¢ãˆã¦ãã®ã¾ã¾uniqã‚’å®Ÿè¡Œã—ãŸæ–¹ãŒè‰¯ã„å ´é¢ã‚‚ã‚ã‚‹ã¨æ€ã„ã¾ã™

è©¦ã—ã«ã€oslist.txtã«å¯¾ã—ã¦uniqã‚’ç›´æ¥é©ç”¨ã—ã¦ã¿ã¾ã™ã€‚
```bash:uniqé©ç”¨
cat oslist.txt | uniq
```

```txt:å®Ÿè¡Œçµæœ
Windows
Mac
Mac
Linux
Windows
Mac
Windows
Linux
Mac
Linux
```

ä»Šå›ã¯é€£ç¶šã—ã¦ã„ãªãã¦ã‚‚é‡è¤‡ã‚’æ’é™¤ã—ã¦ã»ã—ã„ã®ã§ã€äº‹å‰ã«sortã‚’ã—ãŸä¸Šã§uniqã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ã—ã‹ã—ã€sortã‚³ãƒãƒ³ãƒ‰ã¯ä¸€èˆ¬çš„ã«ã¯ÎŸ(NlogN)ã®æ™‚é–“è¨ˆç®—é‡ãŒã‹ã‹ã‚‹ã¨ã•ã‚Œã¦ã„ã¾ã™ã€‚[^1]
[^1]: ã‚½ãƒ¼ãƒˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å®Ÿè£…ã«ã‚ˆã‚‹é•ã„ã‚‚ã‚ã‚Šã€å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ã®çŠ¶æ…‹ã«ã‚ˆã£ã¦ã¯O(N)ã«è¿‘ã„æ™‚é–“ã§å‡¦ç†ã‚’ã—ãŸã‚Šã€æœ€æ‚ªã®å ´åˆã¯ÎŸ(N**2)ã‹ã‹ã£ãŸã‚Šã™ã‚‹å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚

ã‚½ãƒ¼ãƒˆã®å¿…è¦ãŒãªã„å ´åˆã¯awkã‚’ä½¿ç”¨ã—ãŸæ–¹ãŒè¨ˆç®—é‡ã®é¢ã§åŠ¹ç‡ãŒè‰¯ã„ã§ã™ã€‚

ã‚ãˆã¦awkã§ã‚„ã‚‹æ„å‘³ã¯ã€ä¸»ã«ä»¥ä¸‹ãŒç†ç”±ã«ãªã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚
- å‡ºåŠ›é †ç•ªã‚’æ„è­˜ã™ã‚‹å¿…è¦ãŒãªã„
- è¡Œã®ç™»å ´é †åºã‚’å´©ã—ãŸããªã„

`sort | uniq` ã¨ `sort -u`ã§ã¯å¾Œè€…ã®æ–¹ãŒé€Ÿåº¦ãŒé€Ÿã„ã§ã™ãŒã€
`sort | uniq`ã‚’ç”¨ã„ã‚‹ã¨
```bash
# ç™»å ´å›æ•°ã®å¤šã„é †ã«ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚’å‡ºåŠ›ã™ã‚‹
cat oslist.txt | sort | uniq -c | sort -nr
```
```txt:å®Ÿè¡Œçµæœ
      6 Mac
      5 Windows
      3 Linux
```
ã¨ã„ã£ãŸä½¿ã„æ–¹ãŒå‡ºæ¥ã¾ã™ã€‚[^1]
[^1]: å°‘ã—é¢å€’ãã•ã„ã§ã™ãŒã€awkã§ã‚‚é€£æƒ³é…åˆ—ã‚’ç”¨ã„ã¦é›†è¨ˆã¯å‡ºæ¥ã¾ã™ã€‚

çŠ¶æ³ã«ã‚ˆã£ã¦ä¸Šæ‰‹ãä½¿ã„åˆ†ã‘ã‚‰ã‚Œã‚‹ã¨è‰¯ã„ã¨æ€ã„ã¾ã™ã€‚

## ç‰¹å®šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ã®é‡è¤‡æ’é™¤
awkã§ã¯è¤‡æ•°ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®é–¢é€£ã—ãŸé‡è¤‡æ’é™¤ãªã©ã‚‚å¯èƒ½ã§ã™ã€‚
è¡Œå…¨ä½“ã§ã¯ãªãã€ç‰¹å®šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ã®é‡è¤‡ã‚’ç¢ºèªã—ãŸã„å ´åˆã¯awkã‚’ä½¿ç”¨ã™ã‚‹ã¨ã‚¹ãƒãƒ¼ãƒˆã§ã™ã€‚å¤©æ°—æƒ…å ±ã®ä¾‹ã§ã™ã¨ã€ç™»å ´ã™ã‚‹å¤©æ°—ã®å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’çŸ¥ã‚ŠãŸã„ï¼ãªã©ã€‚
3åˆ—ç›®ã¯å¤©æ°—ã®åˆ†é¡ã€4åˆ—ç›®ã¯å…·ä½“çš„ãªå¤©æ°—ã®èª¬æ˜ãŒè¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€4åˆ—ç›®ã‚’å…ƒã«æŠ½å‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
```bash
cat openweatherdata.csv | awk -F, 'NR>1&&!a[$4]++{print $4}'
```
```txt:å®Ÿè¡Œçµæœ
æ›‡ã‚ŠãŒã¡
é›²
æ™´å¤©
è–„ã„é›²
åšã„é›²
å°é›¨
é©åº¦ãªé›¨
```

awkã‚’ã‚ã‚‹ç¨‹åº¦ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹ã¾ã§ã¯ã€`grep -o` ã§ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã†ã¾ãæŠ½å‡ºã—ã¦ï¼ˆã¾ãŸã¯`sed -E`ã§å¾Œæ–¹å‚ç…§ã‚’åˆ©ç”¨ã—ã¦ç½®æ›ã™ã‚‹ãªã©â€¦ï¼‰ã€ãã“ã‹ã‚‰`sort -u`ã¨ã—ã¦çµæœã‚’å¾—ã¦ã„ã¾ã—ãŸã€‚
awkã ã¨éå¸¸ã«ã‚·ãƒ³ãƒ—ãƒ«ã§ç„¡é§„ãŒãªãã€awk1ã¤ã§å®Œçµã—ã¦ã„ã¾ã™ã€‚


# å®Ÿè·µä¾‹3. é›†è¨ˆ
## åˆè¨ˆãƒ»å¹³å‡ã‚’è¨ˆç®—
## ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ä½œæˆ

# å®Ÿè·µä¾‹4. å‰è¡Œã¨æ¯”è¼ƒã—ãªãŒã‚‰ã®æ¡ä»¶åˆ†å²
openweatherdata.csvã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
å‰è¡Œã®æƒ…å ±ã‚’ã‚‚ã¨ã«åˆ¤å®šã‚’è¡Œã†â€¦ã¨ã„ã†ä¾‹ã‚’2ã¤ç´¹ä»‹ã—ã¾ã™ã€‚

## 4-1. å¤©æ°—ãŒå¤‰åŒ–ã™ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ã¿ã‚’å‡ºåŠ›ã™ã‚‹
å‡ºåŠ›çµæœã¯3æ™‚é–“ç½®ãã«å‡ºåŠ›ã•ã‚Œã¦ã„ã¾ã™ãŒã€ä¾‹ãˆã°ä»¥ä¸‹
```
2022-03-05,12:00:00,Clear,æ™´å¤©,13.28,13.28,13.28,32
2022-03-05,15:00:00,Clear,æ™´å¤©,17.62,17.62,17.62,27
2022-03-05,18:00:00,Clear,æ™´å¤©,15.99,15.99,15.99,30
2022-03-05,21:00:00,Clear,æ™´å¤©,13.77,13.77,13.77,35
2022-03-06,00:00:00,Clear,æ™´å¤©,9.61,9.61,9.61,35
2022-03-06,03:00:00,Clouds,è–„ã„é›²,7.41,7.41,7.41,32
```

3/5 12æ™‚ï½3/6 0æ™‚ã¾ã§ã¯ãšã£ã¨Clear,æ™´å¤©ã¨ãªã£ã¦ã„ã¾ã™ã­ã€‚
ãã—ã¦å¤©æ°—ãŒå¤‰ã‚ã‚‹ã®ã¯3/6 3æ™‚ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã™ã€‚
3æ™‚é–“çµŒã£ã¦ã‚‚4åˆ—ç›®ã®æƒ…å ±ãŒå¤‰ã‚ã‚‰ãªã‘ã‚Œã°ã€å‡ºåŠ›ã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ã‚‡ã†ï¼


```bash
cat openweatherdata.csv | awk -F',' 'NR>1&&tmp!=$4{print $0}{tmp=$4}' | column -s, -t
```
```txt:å®Ÿè¡Œçµæœ
2022-03-05  03:00:00  Clouds  æ›‡ã‚ŠãŒã¡  8.21   9.04   8.21   75
2022-03-05  06:00:00  Clouds  é›²        8.09   8.24   8.09   72
2022-03-05  12:00:00  Clear   æ™´å¤©      13.28  13.28  13.28  32
2022-03-06  03:00:00  Clouds  è–„ã„é›²    7.41   7.41   7.41   32
2022-03-06  06:00:00  Clouds  æ›‡ã‚ŠãŒã¡  7.31   7.31   7.31   27
2022-03-06  18:00:00  Clouds  é›²        8.24   8.24   8.24   26
2022-03-06  21:00:00  Clouds  è–„ã„é›²    7.25   7.25   7.25   29
2022-03-07  00:00:00  Clear   æ™´å¤©      6.7    6.7    6.7    30
2022-03-07  09:00:00  Clouds  é›²        7.92   7.92   7.92   24
2022-03-07  12:00:00  Clouds  åšã„é›²    10.48  10.48  10.48  24
2022-03-07  21:00:00  Rain    å°é›¨      8.2    8.2    8.2    60
2022-03-08  03:00:00  Rain    é©åº¦ãªé›¨  5.55   5.55   5.55   89
2022-03-08  06:00:00  Rain    å°é›¨      4.87   4.87   4.87   87
2022-03-08  12:00:00  Clouds  åšã„é›²    6.36   6.36   6.36   76
2022-03-08  15:00:00  Clouds  æ›‡ã‚ŠãŒã¡  9.18   9.18   9.18   58
2022-03-08  18:00:00  Clouds  è–„ã„é›²    9.5    9.5    9.5    53
2022-03-09  00:00:00  Clouds  æ›‡ã‚ŠãŒã¡  7.33   7.33   7.33   55
2022-03-09  03:00:00  Clouds  é›²        6.47   6.47   6.47   50
2022-03-09  06:00:00  Clouds  è–„ã„é›²    5.98   5.98   5.98   53
2022-03-09  09:00:00  Clouds  é›²        7.6    7.6    7.6    46
2022-03-09  12:00:00  Clouds  æ›‡ã‚ŠãŒã¡  9.82   9.82   9.82   40
2022-03-09  18:00:00  Clouds  é›²        11.11  11.11  11.11  41
2022-03-10  00:00:00  Clouds  è–„ã„é›²    9.6    9.6    9.6    59
```

ã•ã™ãŒã«grep/sedã§ã“ã®ã‚ˆã†ãªå‡¦ç†ã‚’ã™ã‚‹ã®ã¯è‹¦ã—ã„ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚
ãã‚‚ãã‚‚grep/sedã¯æ”¹è¡Œã‚’è·¨ã„ã§ã®å‡¦ç†ãŒè‹¦æ‰‹ã¨ã„ã†å¼±ç‚¹ãŒã‚ã‚Šã¾ã™ã€‚[^1]
[^1]: ã©ã¡ã‚‰ã‚‚-zã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç”¨ã„ã¦å‡¦ç†ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™
è¤‡æ•°è¡Œã‚’è·¨ã„ã§ã®åˆ¤å®šãŒå¾—æ„ã¨ã„ã†ã®ã¯awkã®å¼·ã¿ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚

## 4-2. æ—¥ä»˜è¡¨è¨˜ã¯â†‘ã¨åŒã˜å ´åˆã¯ç©ºç™½ã¨ã™ã‚‹
Excelã§ã‚ˆãã‚ã‚‹ã‚„ã¤ã§ã™ã­ã€‚èª°ã‚‚ãŒExcelåˆå¿ƒè€…ã®é ƒã«èª¿ã¹ã¦ã„ãŸã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚
awkã¯Linuxã‚³ãƒãƒ³ãƒ‰ã®ã¿ãªã‚‰ãšã€è¡¨è¨ˆç®—ã‚½ãƒ•ãƒˆã¨ã‚‚æ¯”è¼ƒã•ã‚Œã‚‹å­˜åœ¨ã ã¨æ€ã£ã¦ã„ã¾ã™ã€‚

```bash
cat openweatherdata.csv | awk -F',' 'BEGIN{OFS=","}NR>1{if(tmp==$1){$1=""}else{tmp=$1}}NR==1{tmp=$1}{print $0}' | column -s, -t
```

:::details å®Ÿè¡Œçµæœ

```txt:4-2å®Ÿè¡Œçµæœ
æ—¥ä»˜        æ™‚åˆ»      å¤©æ°—    èª¬æ˜      æ°—æ¸©   æœ€é«˜æ°—æ¸©  æœ€ä½æ°—æ¸©  æ¹¿åº¦
2022-03-05  03:00:00  Clouds  æ›‡ã‚ŠãŒã¡  8.21   9.04      8.21      75
            06:00:00  Clouds  é›²        8.09   8.24      8.09      72
            09:00:00  Clouds  é›²        9.51   9.51      9.51      57
            12:00:00  Clear   æ™´å¤©      13.28  13.28     13.28     32
            15:00:00  Clear   æ™´å¤©      17.62  17.62     17.62     27
            18:00:00  Clear   æ™´å¤©      15.99  15.99     15.99     30
            21:00:00  Clear   æ™´å¤©      13.77  13.77     13.77     35
2022-03-06  00:00:00  Clear   æ™´å¤©      9.61   9.61      9.61      35
            03:00:00  Clouds  è–„ã„é›²    7.41   7.41      7.41      32
            06:00:00  Clouds  æ›‡ã‚ŠãŒã¡  7.31   7.31      7.31      27
            09:00:00  Clouds  æ›‡ã‚ŠãŒã¡  9.04   9.04      9.04      26
            12:00:00  Clouds  æ›‡ã‚ŠãŒã¡  10.71  10.71     10.71     21
            15:00:00  Clouds  æ›‡ã‚ŠãŒã¡  10.88  10.88     10.88     20
            18:00:00  Clouds  é›²        8.24   8.24      8.24      26
            21:00:00  Clouds  è–„ã„é›²    7.25   7.25      7.25      29
2022-03-07  00:00:00  Clear   æ™´å¤©      6.7    6.7       6.7       30
            03:00:00  Clear   æ™´å¤©      5.89   5.89      5.89      33
            06:00:00  Clear   æ™´å¤©      5.49   5.49      5.49      36
            09:00:00  Clouds  é›²        7.92   7.92      7.92      24
            12:00:00  Clouds  åšã„é›²    10.48  10.48     10.48     24
            15:00:00  Clouds  åšã„é›²    11.74  11.74     11.74     38
            18:00:00  Clouds  åšã„é›²    9.66   9.66      9.66      59
            21:00:00  Rain    å°é›¨      8.2    8.2       8.2       60
2022-03-08  00:00:00  Rain    å°é›¨      7.56   7.56      7.56      69
            03:00:00  Rain    é©åº¦ãªé›¨  5.55   5.55      5.55      89
            06:00:00  Rain    å°é›¨      4.87   4.87      4.87      87
            09:00:00  Rain    å°é›¨      4.76   4.76      4.76      86
            12:00:00  Clouds  åšã„é›²    6.36   6.36      6.36      76
            15:00:00  Clouds  æ›‡ã‚ŠãŒã¡  9.18   9.18      9.18      58
            18:00:00  Clouds  è–„ã„é›²    9.5    9.5       9.5       53
            21:00:00  Clouds  è–„ã„é›²    7.75   7.75      7.75      60
2022-03-09  00:00:00  Clouds  æ›‡ã‚ŠãŒã¡  7.33   7.33      7.33      55
            03:00:00  Clouds  é›²        6.47   6.47      6.47      50
            06:00:00  Clouds  è–„ã„é›²    5.98   5.98      5.98      53
            09:00:00  Clouds  é›²        7.6    7.6       7.6       46
            12:00:00  Clouds  æ›‡ã‚ŠãŒã¡  9.82   9.82      9.82      40
            15:00:00  Clouds  æ›‡ã‚ŠãŒã¡  11.26  11.26     11.26     36
            18:00:00  Clouds  é›²        11.11  11.11     11.11     41
            21:00:00  Clouds  é›²        10.35  10.35     10.35     51
2022-03-10  00:00:00  Clouds  è–„ã„é›²    9.6    9.6       9.6       59
```
:::